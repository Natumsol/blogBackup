---
layout: post
title: "jQuery源码里的正则表达式详解（一）"
date: 2014-08-24 23:37:51 +0800
comments: true
categories: 技术
tags:
	- 正则表达式
	- jQuery
---

最近在读Jquery的源码，遇到了一些正则表达式，因为之前接触的很少，所以jQuery里面复杂的正则给我造成了不小的困扰。经过查资料+实验，算是搞清楚了，特罗列出来，总结一下。

## 匹配数字 
```javascript 
// Used for matching numbers
core_pnum = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,

```
正则表达式`/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/`可以分为四个部分：
<!-- more -->
- `/[+-]?`：用来匹配正负号，正号或负号可以出现一次，也可以不出现
- `(?:\d*\.|)`：用来匹配类似`1.2`，`.444`，`0.444`这样的数字。`(?:pattern)`表示一个非捕获分组，意思是不进行存储供以后使用。`\d*\.`匹配小数点前面有<span style = "font-weight:bold">零个</span>或<span style = "font-weight:bold">多个</span>数字的情况。最后是`|`，后面接的是空，表示也就是表示这个`(?:\d*\.|)`<span style = "font-weight:bold">这个非捕获分组可以进行匹配，如果匹配失败则匹配空。</span>
- `\d+`：用来匹配一个或多个数字。
- `(?:[eE][+-]?\d+|)`:这也是一个非捕获分组，用来匹配科学计数法的指数部分，类似`e2`，`e-2`，`E+23`，这样的字符串。最后的`|`也表示这个非捕获分组可以进行匹配，如果匹配失败则匹配空。

整个正则表达的意思就是可以同时匹配小数和科学计数法两种计数模式。

## 匹配HTML标签和ID  #
```javascript
// A simple way to check for HTML strings
// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)
// Strict HTML recognition (#11290: must start with <)
rquickExpr = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
```
正则表达式`/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/`可以分为五个部分来看，分别是：

- `^(?:pattern)$`:匹配开头或者结尾，且是一个非捕获性分组。
- `\s*`：用来匹配一个到多个空格。
- `(<[\w\W]+>)`：用来匹配HTML标签的，比如`<div>`，`<DIV>`，`<span>`类似的。
- `[^>]*`：用来匹配除`>`之外的任意字符，0个到多个。
- `#([\w-]*)`用来匹配带上`#`的任意字符，包括连字符`-`与下划线`_`。


## 匹配HTML单标签  #
```javascript
// Match a standalone tag
rsingleTag = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,

```
正则表达式`/^<(\w+)\s*\/?>(?:<\/\1>|)$/`用来匹配列类似`<br />`，`<span></span>`这样的标签。可以分两部分来看：

- `<(\w+)\s*\/?>`:一定要匹配的部分。可以匹配的字符串可以为`<br      />`，`<br/>`， `<span     >`。
- `(?:<\/\1>|)`：可选匹配的部分。其中`\1`表示引用第一个捕获性分组，也就是分组`(\w+)`。这样做有两个好处：1.使整个正则结构清晰，简洁。2.不会形成另一个捕获性分组。这个正则用于匹配非自闭和标签的后半部分（注：自闭和标签是类似`<br />`这样的标签。非自闭和标签是类似于`<span></span>`这样的标签）。`|`表示这个分组是可选匹配的。
